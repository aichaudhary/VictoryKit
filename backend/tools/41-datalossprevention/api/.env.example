# ========================================
# DataLossPrevention (DLP) - Tool #41
# Enterprise Data Loss Prevention System
# Port: 4041 (API) | 3041 (Frontend) | 8041 (ML)
# ========================================

# Server Configuration
PORT=4041
NODE_ENV=development
API_VERSION=v1

# MongoDB Connection
MONGODB_URI=mongodb://localhost:27017/victorykit_dlp

# Redis for Real-time Caching & Pub/Sub
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=

# ML Engine Configuration
ML_ENGINE_URL=http://localhost:8041
ML_ENGINE_TIMEOUT=30000

# JWT Authentication
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=24h

# ========================================
# SECURITY PLATFORM INTEGRATIONS
# ========================================

# Microsoft Sentinel (Azure SIEM)
# Get from: https://portal.azure.com → Log Analytics workspace → Agents management
SENTINEL_WORKSPACE_ID=your-sentinel-workspace-id
SENTINEL_SHARED_KEY=your-sentinel-shared-key
SENTINEL_LOG_TYPE=DLPIncidents

# CrowdStrike Falcon
# Get from: https://falcon.crowdstrike.com → Support → API Clients and Keys
CROWDSTRIKE_CLIENT_ID=your-crowdstrike-client-id
CROWDSTRIKE_CLIENT_SECRET=your-crowdstrike-client-secret
CROWDSTRIKE_BASE_URL=https://api.crowdstrike.com

# Palo Alto Cortex XSOAR
# Get from: XSOAR → Settings → Integrations → API Keys
CORTEX_XSOAR_API_KEY=your-xsoar-api-key
CORTEX_XSOAR_URL=https://your-xsoar-instance.com

# Splunk Integration
# Get from: Splunk → Settings → Data Inputs → HTTP Event Collector
SPLUNK_HEC_URL=https://your-splunk-instance:8088
SPLUNK_HEC_TOKEN=your-splunk-hec-token
SPLUNK_INDEX=dlp_events

# ========================================
# CLOUD STORAGE INTEGRATIONS (for DLP Scanning)
# ========================================

# Microsoft 365 (SharePoint, OneDrive, Teams, Outlook)
# Get from: https://portal.azure.com → Azure Active Directory → App registrations → New registration
# Required permissions: Files.Read.All, Sites.Read.All, Mail.Read, ChannelMessage.Read.All
AZURE_AD_TENANT_ID=your-tenant-id
AZURE_AD_CLIENT_ID=your-client-id
AZURE_AD_CLIENT_SECRET=your-client-secret

# Google Workspace (Drive, Gmail, Chat)
# Get from: https://console.cloud.google.com → APIs & Services → Credentials → Create Service Account
# Enable: Google Drive API, Gmail API, Admin SDK
# Set up domain-wide delegation in Google Admin Console
GOOGLE_SERVICE_ACCOUNT_EMAIL=dlp-scanner@project-id.iam.gserviceaccount.com
GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
GOOGLE_DOMAIN=yourdomain.com

# Slack DLP
# Get from: https://api.slack.com/apps → Create New App → OAuth & Permissions
# Required scopes: channels:history, channels:read, files:read, chat:write, users:read
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_SIGNING_SECRET=your-slack-signing-secret
SLACK_APP_TOKEN=xapp-your-slack-app-token

# Dropbox
# Get from: https://www.dropbox.com/developers/apps → Create app
DROPBOX_APP_KEY=your-dropbox-app-key
DROPBOX_APP_SECRET=your-dropbox-app-secret
DROPBOX_ACCESS_TOKEN=your-dropbox-access-token

# Box
# Get from: https://developer.box.com/console → Create New App
BOX_CLIENT_ID=your-box-client-id
BOX_CLIENT_SECRET=your-box-client-secret
BOX_DEVELOPER_TOKEN=your-box-developer-token

# AWS S3
# Get from: https://console.aws.amazon.com → IAM → Users → Create User → Attach S3ReadOnlyAccess policy
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1

# Azure Blob Storage
# Get from: https://portal.azure.com → Storage accounts → Access keys
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=xxx;AccountKey=xxx

# ========================================
# EMAIL SECURITY INTEGRATIONS
# ========================================

# Proofpoint
# Get from: https://admin.proofpoint.com → Settings → API Credentials
PROOFPOINT_API_KEY=your-proofpoint-api-key
PROOFPOINT_API_SECRET=your-proofpoint-secret

# Mimecast
# Get from: https://administration.mimecast.com → Services → API and Platform Integrations
MIMECAST_BASE_URL=https://api.mimecast.com
MIMECAST_ACCESS_KEY=your-mimecast-access-key
MIMECAST_SECRET_KEY=your-mimecast-secret-key
MIMECAST_APP_ID=your-mimecast-app-id

# ========================================
# ENDPOINT DLP (Agent Communication)
# ========================================

ENDPOINT_AGENT_SECRET=your-agent-secret-key
ENDPOINT_HEARTBEAT_INTERVAL=60000
ENDPOINT_MAX_OFFLINE_DURATION=300000

# ========================================
# THREAT INTELLIGENCE FEEDS
# ========================================

# VirusTotal
# Get from: https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=your-virustotal-api-key

# Have I Been Pwned
# Get from: https://haveibeenpwned.com/API/Key
HIBP_API_KEY=your-hibp-api-key

# ========================================
# NOTIFICATION & ALERTING
# ========================================

# Email Notifications (SMTP)
SMTP_HOST=smtp.office365.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=dlp-alerts@yourdomain.com
SMTP_PASS=your-smtp-password
SMTP_FROM=DLP Alerts <dlp-alerts@yourdomain.com>
DLP_ALERT_EMAILS=security@yourdomain.com,compliance@yourdomain.com

# SendGrid (Alternative)
# Get from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=your-sendgrid-api-key

# Slack Notifications (Webhook)
# Get from: https://api.slack.com/apps → Incoming Webhooks
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/xxx/xxx
SLACK_ALERT_CHANNEL=#security-alerts

# Microsoft Teams Notifications
# Get from: Teams Channel → Connectors → Incoming Webhook
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/xxx

# PagerDuty (Critical Alerts)
# Get from: https://support.pagerduty.com/docs/api-access-keys
PAGERDUTY_API_KEY=your-pagerduty-api-key
PAGERDUTY_SERVICE_ID=your-pagerduty-service-id

# ========================================
# FILE SCANNING CONFIGURATION
# ========================================

# Limits
MAX_FILE_SIZE_MB=100
MAX_SCAN_TIMEOUT_MS=30000
MAX_CONCURRENT_SCANS=10

# Supported File Types
SCAN_FILE_TYPES=pdf,doc,docx,xls,xlsx,ppt,pptx,txt,csv,json,xml,html,eml,msg

# Content Extraction
ENABLE_OCR=true
OCR_LANGUAGE=eng
ENABLE_DEEP_INSPECTION=true

# ========================================
# CLASSIFICATION & POLICY
# ========================================

# Auto-Classification
ENABLE_AUTO_CLASSIFICATION=true
CLASSIFICATION_CONFIDENCE_THRESHOLD=0.75

# Default Policy Actions
DEFAULT_POLICY_ACTION=audit
ENABLE_AUTO_REMEDIATION=false

# Data Retention
INCIDENT_RETENTION_DAYS=365
SCAN_LOG_RETENTION_DAYS=90

# ========================================
# COMPLIANCE SETTINGS
# ========================================

# Internal Domains (for detecting external sharing)
INTERNAL_DOMAINS=yourdomain.com,yourcompany.net

# Compliance Frameworks
ENABLED_FRAMEWORKS=GDPR,HIPAA,PCI-DSS,SOX,CCPA

# ========================================
# FEATURE FLAGS
# ========================================

ENABLE_REALTIME_MONITORING=true
ENABLE_ENDPOINT_DLP=true
ENABLE_CLOUD_DLP=true
ENABLE_EMAIL_DLP=true
ENABLE_NETWORK_DLP=false
ENABLE_ML_CLASSIFICATION=true
ENABLE_EXACT_DATA_MATCH=false
ENABLE_DOCUMENT_FINGERPRINTING=false

# ========================================
# LOGGING & DEBUGGING
# ========================================

LOG_LEVEL=info
LOG_FORMAT=json
ENABLE_REQUEST_LOGGING=true
ENABLE_PERFORMANCE_METRICS=true

# Debug
DEBUG=dlp:*
