# ================================================================
# ZeroDayDetect - Tool #03 Environment Configuration
# ================================================================
# Copy this file to .env and fill in your values
# NEVER commit your actual .env file to version control!
# ================================================================

# Environment
NODE_ENV=development

# Server Configuration
PORT=4003
HOST=0.0.0.0

# Database
MONGODB_URI=mongodb://localhost:27017/zerodaydetect_db
REDIS_URL=redis://localhost:6379

# ML Engine
ML_ENGINE_URL=http://localhost:8003

# JWT Configuration (inherited from API Gateway)
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# ================================================================
# THREAT INTELLIGENCE API KEYS
# ================================================================

# VirusTotal - Malware & IOC Analysis
# Get key: https://www.virustotal.com/gui/join-us
VIRUSTOTAL_API_KEY=your-virustotal-api-key

# AbuseIPDB - IP Reputation & Blacklists
# Get key: https://www.abuseipdb.com/account/api
ABUSEIPDB_API_KEY=your-abuseipdb-api-key

# Shodan - Internet Intelligence
# Get key: https://account.shodan.io/
SHODAN_API_KEY=your-shodan-api-key

# AlienVault OTX - Open Threat Exchange
# Get key: https://otx.alienvault.com/api
ALIENVAULT_OTX_API_KEY=your-alienvault-otx-api-key

# GreyNoise - Internet Scanner Intelligence
# Get key: https://www.greynoise.io/plans
GREYNOISE_API_KEY=your-greynoise-api-key

# ================================================================
# VULNERABILITY INTELLIGENCE
# ================================================================

# NVD (National Vulnerability Database)
# Get key: https://nvd.nist.gov/developers/request-an-api-key
NVD_API_KEY=your-nvd-api-key

# Vulners - Vulnerability Database
# Get key: https://vulners.com/
VULNERS_API_KEY=your-vulners-api-key

# CIRCL CVE Search
# No key required for basic access
CIRCL_CVE_URL=https://cve.circl.lu/api

# Exploit-DB Search
EXPLOITDB_API_URL=https://www.exploit-db.com/api/v1

# FIRST EPSS (Exploit Prediction Scoring System)
FIRST_EPSS_URL=https://api.first.org/data/v1/epss

# ================================================================
# MALWARE INTELLIGENCE
# ================================================================

# MalwareBazaar - Malware Sample Database
# Get key: https://bazaar.abuse.ch/
MALWAREBAZAAR_API_KEY=your-malwarebazaar-api-key

# ANY.RUN - Interactive Malware Sandbox
# Get key: https://app.any.run/
ANYRUN_API_KEY=your-anyrun-api-key

# Hybrid Analysis - Malware Analysis
# Get key: https://www.hybrid-analysis.com/
HYBRID_ANALYSIS_API_KEY=your-hybrid-analysis-api-key

# Joe Sandbox - Automated Malware Analysis
# Get key: https://www.joesandbox.com/
JOE_SANDBOX_API_KEY=your-joe-sandbox-api-key

# ================================================================
# DOMAIN & URL INTELLIGENCE
# ================================================================

# URLhaus - Malicious URL Database
# No key required
URLHAUS_API_URL=https://urlhaus-api.abuse.ch/v1

# PhishTank - Phishing URL Database
# Get key: https://www.phishtank.com/api_register.php
PHISHTANK_API_KEY=your-phishtank-api-key

# OpenPhish - Phishing Intelligence
OPENPHISH_URL=https://openphish.com/feed.txt

# Google Safe Browsing
# Get key: https://developers.google.com/safe-browsing/v4/get-started
GOOGLE_SAFEBROWSING_API_KEY=your-google-safebrowsing-api-key

# ================================================================
# ATTACK SURFACE & RECONNAISSANCE
# ================================================================

# Censys - Attack Surface Management
# Get key: https://censys.io/
CENSYS_API_ID=your-censys-api-id
CENSYS_API_SECRET=your-censys-api-secret

# SecurityTrails - DNS & Domain Intelligence
# Get key: https://securitytrails.com/
SECURITYTRAILS_API_KEY=your-securitytrails-api-key

# Spyse - Attack Surface Mapping
# Get key: https://spyse.com/
SPYSE_API_KEY=your-spyse-api-key

# BinaryEdge - Threat Intelligence
# Get key: https://www.binaryedge.io/
BINARYEDGE_API_KEY=your-binaryedge-api-key

# ================================================================
# THREAT FEEDS & MITRE ATT&CK
# ================================================================

# MITRE ATT&CK
MITRE_ATTACK_URL=https://raw.githubusercontent.com/mitre/cti/master/enterprise-attack/enterprise-attack.json

# Abuse.ch Threat Feeds
FEODO_TRACKER_URL=https://feodotracker.abuse.ch/downloads/ipblocklist.json
SSL_BLACKLIST_URL=https://sslbl.abuse.ch/blacklist/sslblacklist.csv
THREATFOX_API_URL=https://threatfox-api.abuse.ch/api/v1

# CISA Known Exploited Vulnerabilities
CISA_KEV_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json

# ================================================================
# NOTIFICATION & ALERTING
# ================================================================

# Slack Webhook for Alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/webhook/url

# PagerDuty Integration
PAGERDUTY_INTEGRATION_KEY=your-pagerduty-integration-key

# Email Alerts (SMTP)
SMTP_HOST=smtp.your-email-provider.com
SMTP_PORT=587
SMTP_USER=alerts@yourdomain.com
SMTP_PASSWORD=your-smtp-password
SMTP_FROM=zerodaydetect-alerts@yourdomain.com

# ================================================================
# RATE LIMITING & CACHING
# ================================================================

# Rate Limits (requests per minute)
RATE_LIMIT_GENERAL=100
RATE_LIMIT_SCAN=10
RATE_LIMIT_INTELLIGENCE=50

# Cache TTL (seconds)
CACHE_TTL_THREAT_INTEL=3600
CACHE_TTL_VULNERABILITY=86400
CACHE_TTL_REPUTATION=1800

# ================================================================
# FEATURE FLAGS
# ================================================================

# Enable/disable features
FEATURE_REALTIME_DETECTION=true
FEATURE_THREAT_HUNTING=true
FEATURE_ATTACK_SURFACE=true
FEATURE_AUTOMATED_RESPONSE=false
FEATURE_THREAT_FEEDS=true
FEATURE_VULNERABILITY_SCANNING=true

# ================================================================
# EXTERNAL INTEGRATIONS
# ================================================================

# Central Grid Service URL (internal)
CENTRAL_GRID_URL=http://localhost:5000/api

# SIEM Integration (optional)
SIEM_ENDPOINT=
SIEM_API_KEY=

# SOAR Integration (optional)
SOAR_ENDPOINT=
SOAR_API_KEY=
