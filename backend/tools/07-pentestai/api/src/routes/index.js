const express = require('express');
const router = express.Router();

const targetController = require('../controllers/targetController');
const testController = require('../controllers/testController');
const findingController = require('../controllers/findingController');

// Target routes
router.post('/targets', targetController.create);
router.get('/targets', targetController.list);
router.get('/targets/:id', targetController.get);
router.put('/targets/:id', targetController.update);
router.delete('/targets/:id', targetController.delete);

// Test routes
router.post('/tests', testController.create);
router.get('/tests', testController.list);
router.get('/tests/:id', testController.get);
router.post('/tests/:id/execute', testController.execute);
router.get('/tests/:id/status', testController.status);

// Finding routes
router.get('/findings', findingController.list);
router.get('/findings/:id', findingController.get);
router.put('/findings/:id/verify', findingController.verify);
router.post('/findings/:id/exploit', findingController.exploit);
router.get('/reports/:testId', findingController.report);

module.exports = router;
