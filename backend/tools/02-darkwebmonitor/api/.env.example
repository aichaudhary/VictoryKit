# =====================================================
# DarkWebMonitor API - Environment Variables
# =====================================================
# Copy this file to .env and fill in your values

# Environment
NODE_ENV=development

# Server
PORT=4002

# Database - MongoDB Atlas
MONGODB_URI=mongodb+srv://<username>:<password>@<cluster>.mongodb.net/darkwebmonitor_db?retryWrites=true&w=majority

# ML Engine (Python service for AI features)
ML_ENGINE_URL=http://localhost:8002

# JWT (inherited from gateway)
JWT_SECRET=your-secret-key-change-in-production

# Logging
LOG_LEVEL=info

# =====================================================
# THREAT INTELLIGENCE API KEYS
# =====================================================
# DarkWebMonitor aggregates from 14+ threat intel sources.
# API keys are OPTIONAL for basic functionality but required for full features.

# -----------------------------------------------------
# 1. AlienVault OTX (Open Threat Exchange)
# -----------------------------------------------------
# Community-driven threat intelligence platform
# Sign up: https://otx.alienvault.com/
# Free tier: Unlimited API calls
# Docs: https://otx.alienvault.com/api
ALIENVAULT_OTX_API_KEY=

# -----------------------------------------------------
# 2. AbuseIPDB
# -----------------------------------------------------
# IP reputation and abuse reports database
# Sign up: https://www.abuseipdb.com/register
# Free tier: 1,000 requests/day
# Pricing: Free | Basic $19/mo | Standard $99/mo
# Docs: https://docs.abuseipdb.com/
ABUSEIPDB_API_KEY=

# -----------------------------------------------------
# 3. VirusTotal
# -----------------------------------------------------
# File and URL malware scanning
# Sign up: https://www.virustotal.com/gui/join-us
# Free tier: 4 requests/min, 500 requests/day
# Pricing: Free | Premium (contact sales)
# Docs: https://developers.virustotal.com/
VIRUSTOTAL_API_KEY=

# -----------------------------------------------------
# 4. Shodan
# -----------------------------------------------------
# Internet-connected device search engine
# Sign up: https://account.shodan.io/register
# Free tier: 100 credits/month (no search)
# Pricing: Membership $49/lifetime | Small $59/mo
# Docs: https://developer.shodan.io/
SHODAN_API_KEY=

# -----------------------------------------------------
# 5. Censys
# -----------------------------------------------------
# Internet asset discovery and analysis
# Sign up: https://censys.io/register
# Free tier: 250 queries/month
# Pricing: Free | Pro $1,000/mo | Enterprise (contact)
# Docs: https://censys.io/api
CENSYS_API_ID=
CENSYS_API_SECRET=

# -----------------------------------------------------
# 6. ThreatFox (abuse.ch)
# -----------------------------------------------------
# Malware IOCs and C2 servers
# Sign up: https://threatfox.abuse.ch/
# Free tier: Unlimited (community project)
# Docs: https://threatfox.abuse.ch/api/
# Note: No API key required for basic queries
THREATFOX_API_KEY=

# -----------------------------------------------------
# 7. URLhaus (abuse.ch)
# -----------------------------------------------------
# Malicious URLs database
# Free tier: Unlimited (community project)
# Docs: https://urlhaus-api.abuse.ch/
# Note: No API key required
URLHAUS_ENABLED=true

# -----------------------------------------------------
# 8. Feodo Tracker (abuse.ch)
# -----------------------------------------------------
# Botnet C2 infrastructure tracking
# Free tier: Unlimited (community project)
# Docs: https://feodotracker.abuse.ch/
# Note: No API key required
FEODOTRACKER_ENABLED=true

# -----------------------------------------------------
# 9. SSL Blacklist (abuse.ch)
# -----------------------------------------------------
# Malicious SSL certificates database
# Free tier: Unlimited (community project)
# Docs: https://sslbl.abuse.ch/
# Note: No API key required
SSLBL_ENABLED=true

# -----------------------------------------------------
# 10. MalwareBazaar (abuse.ch)
# -----------------------------------------------------
# Malware samples repository
# Free tier: Unlimited (community project)
# Docs: https://bazaar.abuse.ch/api/
# Note: No API key required for queries
MALWAREBAZAAR_API_KEY=

# -----------------------------------------------------
# 11. CISA (Cybersecurity & Infrastructure Security Agency)
# -----------------------------------------------------
# US Government vulnerability alerts
# Free tier: Unlimited (public data)
# Docs: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
# Note: No API key required
CISA_ENABLED=true

# -----------------------------------------------------
# 12. NVD (National Vulnerability Database)
# -----------------------------------------------------
# CVE and CVSS data from NIST
# Sign up: https://nvd.nist.gov/developers/request-an-api-key
# Free tier: 50 requests/30 seconds without key, more with key
# Docs: https://nvd.nist.gov/developers/vulnerabilities
NVD_API_KEY=

# -----------------------------------------------------
# 13. MITRE ATT&CK
# -----------------------------------------------------
# Adversary tactics and techniques framework
# Free tier: Unlimited (public data)
# Docs: https://attack.mitre.org/resources/attack-data-and-tools/
# Note: No API key required (STIX/TAXII)
MITRE_ATTACK_ENABLED=true

# -----------------------------------------------------
# 14. ThreatCrowd
# -----------------------------------------------------
# Passive DNS and threat correlation
# Free tier: Limited (deprecated, use alternatives)
# Note: Service availability may vary
THREATCROWD_ENABLED=true

# =====================================================
# ADDITIONAL OPTIONAL INTEGRATIONS
# =====================================================

# PassiveTotal (RiskIQ)
# Sign up: https://community.riskiq.com/registration
# Free tier: 15 queries/day
PASSIVETOTAL_API_KEY=
PASSIVETOTAL_USERNAME=

# MaxMind GeoIP2
# Sign up: https://www.maxmind.com/en/geolite2/signup
# Free tier: GeoLite2 (free), GeoIP2 (paid)
MAXMIND_LICENSE_KEY=

# Hybrid Analysis (CrowdStrike Falcon Sandbox)
# Sign up: https://www.hybrid-analysis.com/signup
# Free tier: 200 API requests/month
HYBRID_ANALYSIS_API_KEY=

# =====================================================
# STIX/TAXII CONFIGURATION
# =====================================================
# For threat intelligence sharing

TAXII_SERVER_URL=
TAXII_COLLECTION_ID=
TAXII_USERNAME=
TAXII_PASSWORD=

# MISP Integration
MISP_URL=
MISP_API_KEY=
MISP_VERIFY_SSL=true

# OpenCTI Integration
OPENCTI_URL=
OPENCTI_API_KEY=
