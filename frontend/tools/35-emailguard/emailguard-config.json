{
  "tool": {
    "id": 35,
    "name": "EmailGuard",
    "codeName": "emailguard",
    "version": "1.0.0",
    "description": "Enterprise Email Security & Protection Platform - AI-powered email threat detection, phishing prevention, and compliance management",
    "category": "Email Security",
    "status": "active",
    "ports": {
      "frontend": 3035,
      "api": 4035,
      "aiWebSocket": 6035,
      "mlEngine": 8035
    },
    "domain": "emailguard.maula.ai",
    "database": "emailguard_db"
  },
  "emailSecurity": {
    "threatDetection": {
      "phishing": {
        "enabled": true,
        "methods": ["url_analysis", "domain_reputation", "content_analysis", "sender_verification", "brand_impersonation"],
        "mlModel": "phishing_detector_v3",
        "confidenceThreshold": 0.85
      },
      "malware": {
        "enabled": true,
        "scanners": ["clamav", "yara_rules", "ml_based", "sandbox"],
        "maxFileSize": 52428800,
        "allowedTypes": ["pdf", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "txt", "csv", "zip", "jpg", "png"],
        "blockedTypes": ["exe", "bat", "cmd", "ps1", "vbs", "js", "hta", "scr"]
      },
      "spam": {
        "enabled": true,
        "methods": ["bayesian_filter", "blacklist", "greylist", "content_analysis", "sender_score"],
        "spamThreshold": 5.0,
        "bulkThreshold": 7.0
      },
      "bec": {
        "enabled": true,
        "description": "Business Email Compromise detection",
        "checks": ["executive_impersonation", "wire_transfer_requests", "urgency_analysis", "domain_typosquatting", "reply_to_mismatch"]
      },
      "spoofing": {
        "enabled": true,
        "checks": ["spf", "dkim", "dmarc", "arc", "bimi"],
        "strictMode": true
      }
    },
    "emailAuthentication": {
      "spf": {
        "enabled": true,
        "failAction": "quarantine",
        "softfailAction": "tag"
      },
      "dkim": {
        "enabled": true,
        "keyLength": 2048,
        "selector": "maula",
        "failAction": "quarantine"
      },
      "dmarc": {
        "enabled": true,
        "policy": "quarantine",
        "rua": "mailto:dmarc-rua@maula.ai",
        "ruf": "mailto:dmarc-ruf@maula.ai",
        "percentage": 100
      },
      "arc": {
        "enabled": true,
        "description": "Authenticated Received Chain"
      },
      "bimi": {
        "enabled": true,
        "description": "Brand Indicators for Message Identification"
      }
    },
    "contentAnalysis": {
      "dlp": {
        "enabled": true,
        "description": "Data Loss Prevention",
        "patterns": [
          {
            "name": "credit_card",
            "regex": "\\b(?:\\d{4}[- ]?){3}\\d{4}\\b",
            "action": "block"
          },
          {
            "name": "ssn",
            "regex": "\\b\\d{3}-\\d{2}-\\d{4}\\b",
            "action": "block"
          },
          {
            "name": "api_key",
            "regex": "(?:api[_-]?key|apikey)[\\s]*[=:][\\s]*['\"][a-zA-Z0-9]{20,}",
            "action": "quarantine"
          },
          {
            "name": "password",
            "regex": "(?:password|passwd|pwd)[\\s]*[=:][\\s]*['\"][^'\"]+",
            "action": "quarantine"
          }
        ]
      },
      "languageDetection": {
        "enabled": true,
        "supportedLanguages": ["en", "es", "fr", "de", "zh", "ja", "ar", "pt", "ru", "hi"]
      },
      "sentimentAnalysis": {
        "enabled": true,
        "urgencyDetection": true,
        "threatLevelAssessment": true
      },
      "linkAnalysis": {
        "enabled": true,
        "urlRewriting": true,
        "timeOfClickProtection": true,
        "sandboxedPreview": true
      }
    },
    "attachmentSecurity": {
      "scanning": {
        "enabled": true,
        "antivirusEngines": ["clamav", "sophos", "crowdstrike"],
        "sandboxAnalysis": true,
        "sandboxTimeout": 180
      },
      "fileTypeVerification": {
        "enabled": true,
        "magicNumberCheck": true,
        "extensionValidation": true
      },
      "passwordProtected": {
        "action": "quarantine",
        "promptForPassword": true
      },
      "macroDetection": {
        "enabled": true,
        "action": "strip",
        "allowList": []
      },
      "archiveScanning": {
        "enabled": true,
        "maxNestingLevel": 5,
        "maxFilesInArchive": 100
      }
    }
  },
  "quarantine": {
    "enabled": true,
    "retentionDays": 30,
    "autoRelease": false,
    "notifyUser": true,
    "notifyAdmin": true,
    "digestFrequency": "daily",
    "selfService": {
      "enabled": true,
      "allowRelease": false,
      "allowRequestRelease": true,
      "allowReport": true
    },
    "categories": [
      {
        "name": "spam",
        "retention": 7,
        "userVisible": true
      },
      {
        "name": "phishing",
        "retention": 30,
        "userVisible": false
      },
      {
        "name": "malware",
        "retention": 90,
        "userVisible": false
      },
      {
        "name": "policy_violation",
        "retention": 30,
        "userVisible": true
      }
    ]
  },
  "policies": {
    "types": [
      {
        "name": "inbound",
        "description": "Policies for incoming emails"
      },
      {
        "name": "outbound",
        "description": "Policies for outgoing emails"
      },
      {
        "name": "internal",
        "description": "Policies for internal emails"
      }
    ],
    "actions": ["allow", "block", "quarantine", "tag", "encrypt", "redirect", "notify"],
    "conditions": [
      "sender_domain",
      "recipient_domain",
      "subject_contains",
      "body_contains",
      "attachment_type",
      "attachment_size",
      "sender_reputation",
      "threat_score",
      "spf_result",
      "dkim_result",
      "dmarc_result"
    ],
    "templates": [
      {
        "name": "block_executables",
        "description": "Block emails with executable attachments",
        "condition": "attachment_type in [exe, bat, cmd, ps1]",
        "action": "block"
      },
      {
        "name": "quarantine_external_zips",
        "description": "Quarantine external emails with ZIP attachments",
        "condition": "sender_domain != internal AND attachment_type = zip",
        "action": "quarantine"
      },
      {
        "name": "encrypt_financial",
        "description": "Encrypt emails containing financial data",
        "condition": "contains_financial_data = true",
        "action": "encrypt"
      }
    ]
  },
  "reporting": {
    "dashboards": [
      {
        "name": "security_overview",
        "widgets": ["threat_trends", "top_threats", "blocked_emails", "quarantine_stats"]
      },
      {
        "name": "compliance",
        "widgets": ["dlp_violations", "policy_compliance", "encryption_usage", "audit_log"]
      },
      {
        "name": "user_risk",
        "widgets": ["high_risk_users", "training_status", "phishing_simulation"]
      }
    ],
    "scheduledReports": [
      {
        "name": "daily_summary",
        "frequency": "daily",
        "recipients": ["security-team@maula.ai"]
      },
      {
        "name": "weekly_threat_report",
        "frequency": "weekly",
        "recipients": ["ciso@maula.ai", "security-team@maula.ai"]
      },
      {
        "name": "monthly_compliance",
        "frequency": "monthly",
        "recipients": ["compliance@maula.ai"]
      }
    ],
    "exportFormats": ["pdf", "csv", "json", "xlsx"]
  },
  "integrations": {
    "threatIntelligence": {
      "virusTotal": {
        "enabled": true,
        "features": ["url_scan", "file_scan", "domain_report"]
      },
      "abuseIPDB": {
        "enabled": true,
        "features": ["ip_reputation", "blacklist_check"]
      },
      "phishTank": {
        "enabled": true,
        "features": ["phishing_url_check"]
      },
      "urlScan": {
        "enabled": true,
        "features": ["url_analysis", "screenshot"]
      }
    },
    "emailPlatforms": {
      "microsoft365": {
        "enabled": true,
        "features": ["mailflow_rules", "safe_attachments", "safe_links", "defender_integration"]
      },
      "googleWorkspace": {
        "enabled": true,
        "features": ["gmail_api", "admin_console", "vault_integration"]
      },
      "exchangeOnPrem": {
        "enabled": true,
        "features": ["transport_rules", "content_filtering"]
      }
    },
    "siem": {
      "splunk": {
        "enabled": true,
        "eventTypes": ["threat_detected", "policy_violation", "quarantine_action"]
      },
      "elasticSecurity": {
        "enabled": true,
        "indices": ["emailguard-threats", "emailguard-audit"]
      },
      "microsoftSentinel": {
        "enabled": true,
        "workspaceId": "sentinel-workspace"
      }
    },
    "ticketing": {
      "serviceNow": {
        "enabled": true,
        "autoCreateIncident": true
      },
      "jira": {
        "enabled": true,
        "projectKey": "SEC"
      }
    }
  },
  "userAwareness": {
    "phishingSimulation": {
      "enabled": true,
      "templates": ["credential_harvest", "malware_attachment", "bec_attempt", "gift_card_scam"],
      "frequency": "monthly",
      "trackingEnabled": true
    },
    "trainingModules": [
      {
        "name": "phishing_awareness",
        "duration": 15,
        "mandatory": true
      },
      {
        "name": "bec_prevention",
        "duration": 10,
        "mandatory": true
      },
      {
        "name": "password_security",
        "duration": 10,
        "mandatory": false
      }
    ],
    "reportingButton": {
      "enabled": true,
      "platforms": ["outlook", "gmail", "webmail"],
      "feedbackEnabled": true
    }
  },
  "ai": {
    "provider": "gemini",
    "model": "gemini-1.5-pro",
    "features": [
      "threat_analysis",
      "email_classification",
      "phishing_detection",
      "content_summarization",
      "policy_recommendations",
      "incident_response"
    ],
    "functions": [
      {
        "name": "analyze_email_threat",
        "description": "Perform comprehensive threat analysis on an email including phishing, malware, and BEC detection",
        "category": "threat_detection",
        "inputs": [
          {"name": "emailId", "type": "string", "required": true, "description": "Unique email identifier"},
          {"name": "includeAttachments", "type": "boolean", "required": false, "description": "Include attachment analysis"},
          {"name": "deepScan", "type": "boolean", "required": false, "description": "Perform deep content analysis"}
        ],
        "outputs": ["threatLevel", "threatTypes", "indicators", "recommendations"]
      },
      {
        "name": "classify_email_content",
        "description": "Classify email content for sensitivity, category, and priority",
        "category": "classification",
        "inputs": [
          {"name": "emailId", "type": "string", "required": true, "description": "Email identifier"},
          {"name": "classificationScheme", "type": "string", "required": false, "description": "Classification scheme to use"}
        ],
        "outputs": ["category", "sensitivity", "priority", "tags"]
      },
      {
        "name": "detect_phishing_attempt",
        "description": "Specialized phishing detection with detailed analysis of indicators",
        "category": "phishing",
        "inputs": [
          {"name": "emailContent", "type": "object", "required": true, "description": "Email content including headers and body"},
          {"name": "senderHistory", "type": "boolean", "required": false, "description": "Include sender history analysis"}
        ],
        "outputs": ["isPhishing", "confidence", "indicators", "brandImpersonation", "urgencyScore"]
      },
      {
        "name": "analyze_attachment_risk",
        "description": "Analyze email attachment for potential security risks",
        "category": "attachment",
        "inputs": [
          {"name": "attachmentId", "type": "string", "required": true, "description": "Attachment identifier"},
          {"name": "sandboxAnalysis", "type": "boolean", "required": false, "description": "Run in sandbox"}
        ],
        "outputs": ["riskLevel", "malwareDetected", "fileType", "indicators", "sandboxReport"]
      },
      {
        "name": "assess_sender_reputation",
        "description": "Assess sender reputation and trustworthiness",
        "category": "reputation",
        "inputs": [
          {"name": "senderEmail", "type": "string", "required": true, "description": "Sender email address"},
          {"name": "senderDomain", "type": "string", "required": true, "description": "Sender domain"}
        ],
        "outputs": ["reputationScore", "domainAge", "authenticationStatus", "previousIncidents", "recommendation"]
      },
      {
        "name": "generate_policy_recommendation",
        "description": "Generate email security policy recommendations based on threat landscape",
        "category": "policy",
        "inputs": [
          {"name": "threatData", "type": "object", "required": true, "description": "Recent threat data"},
          {"name": "currentPolicies", "type": "array", "required": false, "description": "Current policy configuration"}
        ],
        "outputs": ["recommendations", "priority", "implementationGuide"]
      },
      {
        "name": "investigate_email_chain",
        "description": "Investigate an email thread for suspicious activity patterns",
        "category": "investigation",
        "inputs": [
          {"name": "threadId", "type": "string", "required": true, "description": "Email thread identifier"},
          {"name": "lookbackDays", "type": "number", "required": false, "description": "Days to look back"}
        ],
        "outputs": ["timeline", "participants", "anomalies", "riskAssessment"]
      },
      {
        "name": "detect_bec_attempt",
        "description": "Detect Business Email Compromise attempts with executive impersonation analysis",
        "category": "bec",
        "inputs": [
          {"name": "emailContent", "type": "object", "required": true, "description": "Email content"},
          {"name": "executiveList", "type": "array", "required": false, "description": "List of executives to check against"}
        ],
        "outputs": ["isBEC", "confidence", "impersonationTarget", "financialRequest", "urgencyIndicators"]
      },
      {
        "name": "summarize_threat_landscape",
        "description": "Generate summary of current email threat landscape for the organization",
        "category": "reporting",
        "inputs": [
          {"name": "timePeriod", "type": "string", "required": true, "description": "Time period for analysis"},
          {"name": "includeRecommendations", "type": "boolean", "required": false, "description": "Include actionable recommendations"}
        ],
        "outputs": ["summary", "topThreats", "trends", "recommendations", "riskScore"]
      },
      {
        "name": "analyze_url_safety",
        "description": "Analyze URL for safety and potential threats",
        "category": "url_analysis",
        "inputs": [
          {"name": "url", "type": "string", "required": true, "description": "URL to analyze"},
          {"name": "followRedirects", "type": "boolean", "required": false, "description": "Follow redirect chain"}
        ],
        "outputs": ["isSafe", "threatType", "redirectChain", "finalDestination", "reputation", "screenshot"]
      }
    ],
    "endpoints": {
      "chat": "/maula-ai",
      "stream": "/maula-ai/stream",
      "functions": "/maula-ai/functions"
    },
    "settings": {
      "maxTokens": 8192,
      "temperature": 0.7,
      "streamResponses": true,
      "contextWindow": 128000
    }
  },
  "compliance": {
    "frameworks": ["GDPR", "HIPAA", "SOX", "PCI-DSS", "CCPA"],
    "dataRetention": {
      "emails": 2555,
      "logs": 365,
      "quarantine": 90
    },
    "encryption": {
      "atRest": "AES-256",
      "inTransit": "TLS-1.3",
      "emailEncryption": ["S/MIME", "PGP", "TLS"]
    },
    "audit": {
      "enabled": true,
      "retentionDays": 365,
      "logLevel": "detailed"
    }
  },
  "ui": {
    "theme": {
      "primary": "#3b82f6",
      "secondary": "#64748b",
      "accent": "#0ea5e9",
      "danger": "#ef4444",
      "warning": "#f59e0b",
      "success": "#22c55e",
      "background": "#0f172a",
      "surface": "#1e293b"
    },
    "components": {
      "emailViewer": true,
      "threatDashboard": true,
      "quarantineManager": true,
      "policyEditor": true,
      "reportGenerator": true,
      "userRiskPanel": true,
      "simulationManager": true,
      "auditLog": true
    },
    "accessibility": {
      "wcag": "2.1-AA",
      "screenReader": true,
      "keyboardNavigation": true
    }
  }
}
